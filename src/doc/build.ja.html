<?xml version='1.0' encoding='EUC-JP'?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang='ja' xml:lang='ja' xmlns='http://www.w3.org/1999/xhtml'>

<head>
  <title>RubyCocoa - RubyCocoaをソースから構築・インストールする</title>
  <meta content='text/html; charset=euc-jp' http-equiv='Content-type'/>
  <meta name='Content-Language' content='ja'/>
  <link href='rubycocoasite.css' rel='stylesheet' type='text/css'/>
</head>

<body>

<!-- main table -->
<table cellspacing='0' cellpadding='0' width='100%'>
<colgroup><col width='100%'/></colgroup>

<!-- body/header - title -->
<tr class='site-title'><td width='100%'>
RubyCocoa<font size='-1'> - A Ruby/Objective-C Bridge for Mac OS X with Cocoa</font>
</td></tr>

<!-- body/header - menubar -->
<tr class='site-menubar'><td width='100%'>
<table cellspacing='0' cellpadding='2' width='100%'>
  <colgroup><col width='80%'/><col width='20%'/></colgroup>
  <tr id='site-menubar'>
  <td align='left'>
    <a href='index.ja.html'>RubyCocoaとは？</a> |
    <a href='getting.ja.html'>ダウンロード</a> |
    <a href='build.ja.html'>ソースから構築</a> |
    <a href='trysamples.ja.html'>サンプルを試す</a> |
    <a href='programming.ja.html'>プログラミング</a> |
    <a href='references.ja.html'>リファレンス</a> |
    <a href='changes.ja.html'>変更点</a> |
    <a href='changelog.html'>変更ログ</a> |
    <a href='faq.ja.html'>FAQ</a> |
    <a href='links.ja.html'>リンク集</a>
  </td>
  <td align='right'>
    <a href='index.en.html'>[英語]</a> [日本語]
  </td>
</tr>
</table>
</td></tr>

<!-- body/main -->
<tr><td width='100%'>
<table cellspacing='0' cellpadding='12' width='100%'>
  <colgroup><col width='80%'/><col width='20%'/></colgroup>
  <tr>

<!-- body/main/contents -->
<td class='body-contents' id='body-contents' valign='top'>
<h1><a name='label:0' id='label:0'>RubyCocoaをソースから構築・インストールする</a></h1><!-- RDLabel: "RubyCocoaをソースから構築・インストールする" -->
<p>この文書ではRubyCocoa 0.4をソースから構築・インストールする方法について
説明します。バイナリ配付をインストールして使う場合にはとくに読む必要はありません。</p>
<p>構築・インストール作業は、Terminalアプリケーションなどからシェルコマンド
を入力して行います。シェルコマンド入力例にはbashを想定して記述しています。
その他のシェル(例えばtcsh)を使っている場合、適当に読み変えてください。</p>
<h2><a name='label:1' id='label:1'>構築・インストールの手順</a></h2><!-- RDLabel: "構築・インストールの手順" -->
<p>構築・インストールは、おおよそ以下のような手順で行います。</p>
<ul>
<li><a href='#label:2'>Rubyの構築・インストール</a></li>
<li><a href='#label:8'>RubyCocoaの構築</a></li>
<li><a href='#label:9'>RubyCocoaの単体テスト</a></li>
<li><a href='#label:10'>RubyCocoaのインストール</a></li>
</ul>
<p>あらかじめどこかにRubyCocoaのソースを展開しておいてください。</p>
<pre>$ cd {どこか}
$ tar zxf rubycocoa-0.4.0.tar.gz</pre>
<p><em>注意</em> StuffItを使うとファイル名の長さの問題でRubyCocoaが正しく
インストールされないのでtarコマンドを使ってください。</p>
<h2><a name='label:2' id='label:2'>Rubyの構築・インストール</a></h2><!-- RDLabel: "Rubyの構築・インストール" -->
<p>RubyCocoaを構築するためには、最低限librubyとRubyに付随するC言語の
ヘッダーファイルが必要となります。ここでは次に示すケースを例に、
RubyCocoaのベースとなるRubyの構築手順を説明します。</p>
<ul>
<li>ソースからインストールしたRuby 1.8</li>
<li>Mac OS X 10.2付属のRuby 1.6.7</li>
</ul>
<p>後者のケースは、RubyCocoa 0.4バイナリパッケージのケースに相当します。
<a href='http://fink.sf.net/'>Fink</a>などのパッケージを使ってRubyを
インストールしている場合などは、それに合わせて読み変えてください。</p>
<h3><a name='label:3' id='label:3'>ソースからインストールしたRuby 1.8</a></h3><!-- RDLabel: "ソースからインストールしたRuby 1.8" -->
<p>Ruby 1.8のソースディレクトリに移動して、以下のように構築・インストール
します。オプションは必要に応じて変更してください。
<a name='footmark:1' href='#foottext:1' id='footmark:1'><sup><small>*1</small></sup></a></p>
<pre>$ CFLAGS='-g -O2 -fno-common' ./configure
$ make
$ make test
$ sudo make install
$ sudo ranlib /usr/local/lib/libruby-static.a  # </pre>
<h3><a name='label:4' id='label:4'>Mac OS X 10.2付属のRuby 1.6.7</a></h3><!-- RDLabel: "Mac OS X 10.2付属のRuby 1.6.7" -->
<h4><a name='label:5' id='label:5'>インストールされているMac OS Xパッケージの確認</a></h4><!-- RDLabel: "インストールされているMac OS Xパッケージの確認" -->
<p>Mac OS X 10.2をインストールした時のオプション設定次第では、必要な
パッケージ(BSD.pkgとBSDSDK.pkg)がインストールされていない可能性があります。
まずはRubyがインストールされているか確認して、必要であればインストール
してください。</p>
<pre>$ ls -dF /Library/Receipts/BSD*.pkg   # 確認
/Library/Receipts/BSD.pkg/   /Library/Receipts/BSDSDK.pkg/</pre>
<p>Mac OS X 10.2にはRubyが含まれていますが、どういうわけかlibruby
が含まれていません。したがって、RubyCocoaを構築するためには、
Ruby 1.6.7のソースからlibrubyを作る必要があります。</p>
<h4><a name='label:6' id='label:6'>Ruby 1.6.7のソースにパッチをあてる</a></h4><!-- RDLabel: "Ruby 1.6.7のソースにパッチをあてる" -->
<p>まず最初にRuby 1.6.7のtarballを展開して、RubyCocoaに付属の
Ruby 1.6.7用パッチをあてます。</p>
<pre>$ cd {どこか}
$ tar zxf ruby-1.6.7.tar.gz
$ cd ruby-1.6.7
$ patch -p1 &lt; {RubyCocoaソース}/ruby-1.6.7-osx10.2.patch</pre>
<h4><a name='label:7' id='label:7'>librubyの構築・インストール</a></h4><!-- RDLabel: "librubyの構築・インストール" -->
<p>Mac OS X付属Rubyの環境に合わせてRuby 1.6.7を構築します。
<a name='footmark:2' href='#foottext:2' id='footmark:2'><sup><small>*2</small></sup></a></p>
<pre>$ rbhost=`ruby -r rbconfig -e "print Config::CONFIG['host']"`
$ CFLAGS='-g -O2 -fno-common' ./configure --prefix=/usr --host=$rbhost
$ make
$ make test</pre>
<p>libruby.aのみをインストールします。</p>
<pre>$ ranlib libruby.a
$ rubyarchdir=`ruby -r rbconfig -e 'print Config::CONFIG["archdir"]'`
$ sudo install -m 0644 libruby.a $rubyarchdir</pre>
<h2><a name='label:8' id='label:8'>RubyCocoaの構築</a></h2><!-- RDLabel: "RubyCocoaの構築" -->
<p>次のように入力してRubyCocoaを構築します。</p>
<pre>$ ruby install.rb --help   # オプションの確認
$ ruby install.rb config
$ ruby install.rb setup</pre>
<p><kbd> ruby install.rb config </kbd>にはいくつかRubyCocoa用のオプションがあります。
必要ならconfigフェーズのときにオプションを指定してください。</p>
<h2><a name='label:9' id='label:9'>RubyCocoaの単体テスト</a></h2><!-- RDLabel: "RubyCocoaの単体テスト" -->
<pre>$ cd {ソース}/tests
$ DYLD_FRAMEWORK_PATH={ソース}/framework/build ruby -I../lib testall.rb</pre>
<p>単体テストにはTest::Unit(testunit-0.1.5)が必要です。</p>
<h2><a name='label:10' id='label:10'>RubyCocoaのインストール</a></h2><!-- RDLabel: "RubyCocoaのインストール" -->
<pre>$ sudo ruby install.rb install</pre>
<p>以上でインストールは完了です。ここまでの手順で以下のものがインストール
されました。</p>
<ul>
<li>/Library/Frameworks/RubyCocoa.framework     : フレームワーク (本体)</li>
<li>{sitedir}/{ruby_version}/osx/addressbook.rb : ライブラリ (stub)</li>
<li>{sitedir}/{ruby_version}/osx/appkit.rb      : ライブラリ (stub)</li>
<li>{sitedir}/{ruby_version}/osx/cocoa.rb       : ライブラリ (stub)</li>
<li>{sitedir}/{ruby_version}/osx/foundation.rb  : ライブラリ (stub)</li>
<li>{sitearchdir}/rubycocoa.bundle              : 拡張ライブラリ (stub)</li>
</ul>
<p><a href='trysamples.ja.html'>「付属サンプルを試してみる」</a> を参考に
動作確認してみてください。</p>
<h2><a name='label:11' id='label:11'>開発動作確認環境</a></h2><!-- RDLabel: "開発動作確認環境" -->
<p>以下の環境で開発動作確認をしています。</p>
<ul>
<li>PowerMacintosh G4/400/384MB or iBook G3/600/384MB</li>
<li>Mac OS X 10.2.3</li>
<li>DevTools 10.2</li>
<li>ruby-1.6.7 (pre-installed in Mac OS X 10.2)</li>
<li>ruby-1.8 (preview 1 from cvs server)</li>
</ul>
<h2><a name='label:12' id='label:12'>ではお楽しみください</a></h2><!-- RDLabel: "ではお楽しみください" -->
<p>感想、アイデア、提案、疑問、質問などなんでも気軽に教えてください。</p>
<p>$Date$</p>
<hr/>
<p class='foottext'>
<a name='foottext:1' href='#footmark:1' id='foottext:1'><sup><small>*1</small></sup></a><small> CFLAGSに'-fno-common'オプションを指定しないと、RubyCocoa.framework
がリンクできないようです </small><br/>
<a name='foottext:2' href='#footmark:2' id='foottext:2'><sup><small>*2</small></sup></a><small> CFLAGSに'-fno-common'オプションを指定しないと、RubyCocoa.framework
がリンクできないようです </small><br/>
</p>
</td>

<!-- body/main/sidebar -->
<td class='body-sidebar' valign='top'>

<!-- <div id="sidebar-news"> -->
<!--   <h2 class="body-sidebar"><a href="news.ja.html">News</a></h2> -->
<!--   <ul class="body-sidebar"> -->
<!--     <li><a href="news.ja.html#news:0">RubyCocoa 0.4 release out (2002.12.24)</a></li> -->
<!--     <li><a href="news.ja.html#news:1">relocate home page (2002.12.24)</a></li> -->
<!--   </ul> -->
<!-- </div> -->
<!-- id="sidebar-news" -->

<div id='sidebar-contents'>
  <h2 class='body-sidebar'>コンテンツ</h2>
  <ul class='body-sidebar'>
    <li><a href='index.ja.html'>RubyCocoaとは？</a></li>
    <li><a href='getting.ja.html'>ダウンロード</a></li>
    <li><a href='build.ja.html'>ソースから構築</a></li>
    <li><a href='trysamples.ja.html'>サンプルを試す</a></li>
    <li><a href='programming.ja.html'>プログラミング</a></li>
    <li><a href='references.ja.html'>リファレンス</a></li>
    <li><a href='changes.ja.html'>変更点</a></li>
    <li><a href='changelog.html'>変更ログ</a></li>
    <li><a href='faq.ja.html'>FAQ</a></li>
    <li><a href='links.ja.html'>関連リンク集</a></li>
  </ul>
</div>

<div id='sidebar-links'>
  <h2 class='body-sidebar'><a href='links.ja.html'>リンク</a></h2>
  <ul class='body-sidebar'>
    <li><a href='http://www.imasy.or.jp/~hisa/mac/rubycocoa/'>RubyCocoa</a></li>
    <li><a href='http://www.imasy.or.jp/~hisa/mac/rubyaeosa/'>RubyAEOSA</a></li>
    <li><a href='http://www.freeml.com/info/rubycocoa@freeml.com'>メーリングリスト (日本語)</a></li>
    <li><a href='http://sourceforge.net/mail/?group_id=44114'>メーリングリスト (英語)</a></li>
    <li><a href='http://sourceforge.net/projects/rubycocoa/'>RubyCocoaプロジェクト</a></li>
    <li><a href='http://mwave.sppd.ne.jp/diary/calc_app/calc_app1.html'>チュートリアル</a></li>
  </ul>
</div>

</td> <!-- end of body/main/sidebar -->

</tr></table></td></tr> <!-- end of body/main -->

<!-- body/footer -->
<tr class='body-footer'><td width='100%'>
<table cellspacing='0' cellpadding='0' width='100%'>
  <tr>
    <td><p align='right'><font size='-1'>
	FUJIMOTO, Hisakuni &lt;hisa@imasy.or.jp&gt;<br/>
	$Date$ $Revision$
	</font></p>
    </td>
  </tr>
</table>
</td></tr>

</table> <!-- end of main table -->
</body>
</html>